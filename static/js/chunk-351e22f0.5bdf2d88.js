(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-351e22f0"],{2743:function(e,t,a){"use strict";a("e488")},4466:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("yi-modal",{attrs:{"dialog-form-visible":e.visible,title:"itemEdit"===e.itemType?"编辑项目":"新增项目"},on:{"on-close-dialog":e.onClose}},[e.visible?a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingStatus["form"],expression:"loadingStatus['form']"}],staticClass:"form-container"},[a("el-form",{ref:"createForm",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[a("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入项目名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"项目描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入项目描述"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),a("el-form-item",{attrs:{label:"项目类型",prop:"itemType"}},[a("el-select",{attrs:{placeholder:"请选择项目类型"},on:{change:e.itemTypeChange},model:{value:e.form.itemType,callback:function(t){e.$set(e.form,"itemType",t)},expression:"form.itemType"}},e._l(e.itemTypeOptions,(function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.code}})})),1)],1),1===e.form.itemType?a("el-form-item",{attrs:{label:"功能包",prop:"targetId"}},[a("el-select",{attrs:{placeholder:"请选择功能包"},model:{value:e.form.targetId,callback:function(t){e.$set(e.form,"targetId",t)},expression:"form.targetId"}},[a("el-option",{attrs:{label:"功能包1",value:"function"}}),a("el-option",{attrs:{label:"服务2",value:"service"}}),a("el-option",{attrs:{label:"使用量3",value:"play"}})],1)],1):e._e(),2===e.form.itemType?a("el-form-item",{attrs:{label:"服务",prop:"targetId"}},[a("el-select",{attrs:{placeholder:"请选择服务"},model:{value:e.form.targetId,callback:function(t){e.$set(e.form,"targetId",t)},expression:"form.targetId"}},e._l(e.timeLimitTypeOptions,(function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.code}})})),1)],1):e._e(),3===e.form.itemType?[a("el-form-item",{attrs:{label:"时限",prop:"timeLimitType"}},[a("el-select",{attrs:{placeholder:"请选择时限"},model:{value:e.form.timeLimitType,callback:function(t){e.$set(e.form,"timeLimitType",t)},expression:"form.timeLimitType"}},e._l(e.timeLimitTypeOptions,(function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.code}})})),1)],1),a("el-form-item",{attrs:{label:"标准数量",prop:"amount"}},[a("el-input",{attrs:{placeholder:"请输入标准数量"},model:{value:e.form.amount,callback:function(t){e.$set(e.form,"amount",t)},expression:"form.amount"}})],1),a("el-form-item",{attrs:{label:"是否可增购"}},[a("el-switch",{model:{value:e.form.increase,callback:function(t){e.$set(e.form,"increase",t)},expression:"form.increase"}})],1)]:e._e()],2)],1):e._e(),a("yi-form-operation",{attrs:{loading:e.loading,"cancel-text":"取 消","button-text":"确 定"},on:{"form-submit":e.onCreateSubmit,"form-reset":e.onClose}})],1)],1)},i=[],r=(a("caad"),a("fb6a"),a("a9e3"),a("d3b7"),a("5530")),o=(a("96cf"),a("1da1")),l=a("a1f4"),s={name:"Index",props:{billingType:{type:Number,default:-1}},data:function(){return{visible:!1,itemType:"",packageType:"",index:"",loading:!1,form:{},rules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"},{pattern:/^[A-Za-z0-9\u4e00-\u9fa5]+$/,message:"请输入汉字、数字、英文"}],itemType:[{required:!0,message:"请选择项目类型",trigger:"blur"}],targetId:[{required:!0,message:"请选择服务/功能包",trigger:"blur"}],timeLimitType:[{required:!0,message:"请输入时限",trigger:"blur"}],amount:[{required:!0,message:"请输入标准数量",trigger:"blur"},{pattern:/^[1-9]\d*$/,message:"请输入正整数"}]}}},computed:{enumStore:function(){return this.$store.state.global&&this.$store.state.global.enums||{}},itemTypeOptions:function(){return 2===this.billingType&&this.enumStore.itemType?this.enumStore.itemType.slice(0,2):this.enumStore.itemType},timeLimitTypeOptions:function(){return this.enumStore.timeLimitType||[]}},methods:{itemTypeChange:function(e){[1,2].includes(e)&&(this.$set(this.form,"targetId",""),this.$set(this.form,"targetName",""))},onCreateSubmit:function(){var e=this;this.$refs["createForm"].validate().then(Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("表单数据",e.form),"packageAdd"!==e.packageType){t.next=8;break}return e.$message.success("添加成功！"),e.$emit("on-change-success",e.packageType,e.itemType,e.form,e.index),e.onClose(),t.abrupt("return",Promise.reject());case 8:return t.abrupt("return","itemAdd"===e.itemType?l["f"](e.form.packageId,e.form):l["j"](Object(r["a"])(Object(r["a"])({},e.form),{},{comboId:e.form.packageId})));case 9:case"end":return t.stop()}}),t)})))).then((function(){e.$message.success("itemAdd"===e.itemType?"添加成功！":"编辑成功！"),e.onClose(),e.$emit("on-refresh")}))},onClose:function(){this.visible=!1,this.form={},this.index=""},onOpen:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;this.visible=!0,this.packageType=e,this.itemType=t,this.form=a,"itemEdit"===t&&(this.index=n)}}},c=s,u=a("2877"),m=Object(u["a"])(c,n,i,!1,null,"9a3135f6",null);t["default"]=m.exports},5770:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("yi-modal",{attrs:{"dialog-form-visible":e.visible,title:"ruleEdit"===e.itemType?"编辑规则":"新增规则"},on:{"on-close-dialog":e.onClose}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingStatus["form"],expression:"loadingStatus['form']"}],staticClass:"form-container"},[e.visible?a("yi-form",{ref:"createForm",attrs:{fields:e.getRuleForm,"default-value":e.defaultValue}}):e._e()],1),a("yi-form-operation",{attrs:{loading:e.loading,"cancel-text":"取 消","button-text":"确 定"},on:{"form-submit":e.onCreateSubmit,"form-reset":e.onClose}})],1)],1)},i=[],r=(a("4de4"),a("caad"),a("a9e3"),a("d3b7"),a("5530")),o=a("6d47"),l=a("a1f4"),s={name:"Index",props:{billingType:{type:Number,default:-1}},data:function(){return{defaultValue:{},visible:!1,title:"新增规则",type:"add",loading:!1,itemType:"",packageType:"",index:""}},computed:{getRuleForm:function(){switch(this.billingType){case 1:return o["default"].ruleForm.filter((function(e){return["timeLimit","price"].includes(e.key)}));case 2:return o["default"].ruleForm.filter((function(e){return["numberRange","price"].includes(e.key)}));case 3:return o["default"].ruleForm;default:return[]}}},methods:{onCreateSubmit:function(){var e=this;this.$refs["createForm"].onAsyncSubmit().then((function(t){if(console.log(t,e.defaultValue),[2,3].includes(e.billingType)){var a=t.numberRange[0],n=t.numberRange[1];if(a>n)return e.$message.error("开始数量不能大于结束数量"),Promise.reject();t=Object(r["a"])(Object(r["a"])({},t),{},{limitStart:a,limitEnd:n})}return"packageAdd"===e.packageType?(e.$message.success("操作成功！"),e.$emit("on-change-success",e.packageType,e.itemType,t,e.index),e.onClose(),Promise.reject()):"ruleAdd"===e.itemType?l["g"](t.comboId,t):l["k"](t)})).then((function(){e.$message.success("ruleAdd"===e.itemType?"添加成功！":"编辑成功！"),e.onClose(),e.$emit("on-refresh")}))},onClose:function(){this.visible=!1,this.defaultValue={}},onOpen:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;console.log(a),this.visible=!0,this.packageType=e,this.itemType=t,this.defaultValue=a,"ruleEdit"===t&&(this.defaultValue=Object(r["a"])(Object(r["a"])({},a),{},{numberRange:[a.limitStart,a.limitEnd]}),this.index=n)}}},c=s,u=a("2877"),m=Object(u["a"])(c,n,i,!1,null,"0dac394d",null);t["default"]=m.exports},"6d47":function(e,t,a){"use strict";a.r(t),t["default"]={columns:[{prop:"id",label:"ID",width:150,align:"center"},{prop:"name",label:"套餐名称"},{prop:"comboNo",label:"套餐编码"},{prop:"productName",label:"所属产品"},{prop:"onTrial",label:"是否试用版",isCustom:!0,customizedName:"onTrial"},{prop:"billingType",label:"计费方式",flatKey:"name"},{prop:"description",label:"套餐描述"},{prop:"status",label:"状态",flatKey:"name"},{prop:"operation",label:"操作",isCustom:!0,customizedName:"operation"}],addForm:[{label:"套餐名称",key:"name",rules:[{required:!0,message:"请输入套餐名称",trigger:"blur"},{pattern:/^[A-Za-z0-9\u4e00-\u9fa5]+$/,message:"请输入汉字、数字、英文"}],hide:!1,readonly:!1,input:{placeholder:"请输入套餐名称",type:"input"}},{label:"套餐描述",key:"description",hide:!1,readonly:!1,input:{placeholder:"请输入套餐描述",type:"input",subtype:"textarea"}},{label:"级别",key:"level",rules:[{required:!0,message:"请选择级别",trigger:"blur"}],hide:!1,readonly:!1,input:{type:"select",options:[{label:"一级",value:1},{label:"二级",value:2},{label:"三级",value:3},{label:"四级",value:4},{label:"五级",value:5},{label:"六级",value:6},{value:"七级",code:7}]}},{label:"所属产品",key:"productId",rules:[{required:!0,message:"请选择所属产品",trigger:"blur"}],hide:!1,readonly:!1,input:{type:"ajaxSelect",resource:"/enums/meta?metaType=1",placeholder:"请选择所属产品",change:!0}},{label:"是否试用版",key:"onTrial",hide:!1,readonly:!1,input:{type:"switch",change:!0}},{label:"试用时间(天)",key:"trialDays",rules:[{required:!0,message:"请输入套餐名称",trigger:"blur"},{pattern:/^[1-9]\d*$/,message:"请输入正整数"}],hide:!0,readonly:!1,input:{placeholder:"请输入",type:"input"}},{label:"套餐数量名称",key:"name12123",rules:[{required:!0,message:"请输入套餐数量名称",trigger:"blur"}],hide:!0,readonly:!1,input:{placeholder:"请输入",type:"input"}}],packageItemList:[{prop:"name",label:"项目名称",align:"center"},{prop:"description",label:"项目描述"},{prop:"itemType",label:"项目类型",isCustom:!0,customizedName:"itemType"},{prop:"content",label:"项目内容",isCustom:!0,customizedName:"content"},{prop:"operation",label:"操作",fixed:"right",isCustom:!0,customizedName:"operation"}],packageRuleList:[{prop:"numRange",label:"数量范围",isCustom:!0,customizedName:"numRange"},{prop:"timeLimit",label:"时长"},{prop:"price",label:"价格"},{prop:"operation",label:"操作",isCustom:!0,customizedName:"operation"}],ruleForm:[{label:"数量范围",key:"numberRange",rules:[{required:!0,message:"请输入数量范围",trigger:"blur"}],hide:!1,readonly:!1,input:{type:"numberRange",placeholder:"请输入数量范围",change:!0}},{label:"时长(天)",key:"timeLimit",rules:[{required:!0,message:"请输入时长",trigger:"blur"},{pattern:/^[1-9]\d*$/,message:"请输入正整数"}],hide:!1,readonly:!1,input:{placeholder:"请输入时长",type:"input"}},{label:"价格(元)",key:"price",rules:[{required:!0,message:"请输入价格",trigger:"blur"},{pattern:/^[+]{0,1}(\d+)$|^[+]{0,1}(\d+\.\d+)$/,message:"请输入数字且为正数"}],hide:!1,readonly:!1,input:{placeholder:"请输入价格",type:"input"}}]}},a1f4:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"m",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"l",(function(){return l})),a.d(t,"e",(function(){return s})),a.d(t,"h",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"i",(function(){return m})),a.d(t,"d",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"j",(function(){return f})),a.d(t,"g",(function(){return g})),a.d(t,"k",(function(){return b}));var n=a("c8cc");function i(){return Object(n["a"])({url:"/combo",method:"GET"})}function r(e){return Object(n["a"])({url:"/combo",method:"PUT",data:e,headers:{loadingTag:"query"}})}function o(e){return Object(n["a"])({url:"/combo/".concat(e),method:"GET"})}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(n["a"])({url:"/combo/".concat(e),method:"PUT",data:t,headers:{loadingTag:"query"}})}function s(e){return Object(n["a"])({url:"/combo",method:"POST",data:e,headers:{loadingTag:"form"}})}function c(e){return Object(n["a"])({url:"/combo/item/".concat(e),method:"DELETE",headers:{loadingTag:"form"}})}function u(e){return Object(n["a"])({url:"/combo/".concat(e,"/item/list"),method:"GET"})}function m(e){return Object(n["a"])({url:"/combo/rule/".concat(e),method:"DELETE",headers:{loadingTag:"form"}})}function d(e){return Object(n["a"])({url:"/combo/".concat(e,"/rule/list"),method:"GET"})}function p(e,t){return Object(n["a"])({url:"/combo/".concat(e,"/item"),method:"POST",data:t})}function f(e){return Object(n["a"])({url:"/combo/item",method:"PUT",data:e})}function g(e,t){return Object(n["a"])({url:"/combo/".concat(e,"/rule"),method:"POST",data:t})}function b(e){return Object(n["a"])({url:"/combo/rule",method:"PUT",data:e})}},dd8b:function(e,t,a){},e488:function(e,t,a){},e52a:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-content-container"},[a("yi-title-bar",[a("template",{slot:"actions"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.onOpenPackageForm("packageAdd")}}},[e._v("新建套餐")])],1)],2),a("div",{staticClass:"customer-body"},[a("yi-table",{ref:"erpTable",attrs:{columns:e.getColumns,data:e.tableData},scopedSlots:e._u([{key:"onTrial",fn:function(t){return[a("span",[e._v(" "+e._s(t.data?"是":"否"))])]}},{key:"operation",fn:function(t){return[a("div",[a("span",{staticClass:"link",on:{click:function(a){return e.onOpenPackageForm("packageEdit",t.row)}}},[e._v("修改")]),a("span",{staticClass:"link",on:{click:function(a){return e.onSetPackageStatus(t.row)}}},[e._v(" "+e._s(t.row.status&&1===t.row.status.code?"下架":"上架")+" ")])])]}}])}),a("yi-table-footer",{attrs:{"current-page":e.pageNum,"on-page-size-change":e.onPageSizeChange,"on-page-change":e.onPageChange,"total-count":e.totalCount}})],1),a("AddForm",{ref:"addFormRef",on:{"on-change-success":e.loadList}})],1)},i=[],r=(a("4de4"),a("96cf"),a("1da1")),o=a("6d47"),l=a("f102"),s=a("a1f4"),c={components:{AddForm:l["default"]},data:function(){return{list:null,listLoading:!0,tableData:[],totalCount:7,pageSize:20,pageNum:1}},computed:{getColumns:function(){return o["default"].columns},getFilters:function(){return o["default"].filter}},created:function(){this.loadList()},mounted:function(){},methods:{loadList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s["c"]({size:e.pageSize,num:e.pageNum});case 3:a=t.sent,n=a.data,i=void 0===n?{}:n,e.tableData=i.data,e.totalCount=i.count,t.next=12;break;case 10:t.prev=10,t.t0=t["catch"](0);case 12:case"end":return t.stop()}}),t,null,[[0,10]])})))()},openDrawer:function(){},onOpenPackageForm:function(e,t){this.$refs.addFormRef.onOpen(e,t)},operation:function(e){switch(e){case"add":break;case"edit":this.$refs.addFormRef.onOpen();break}},handleSearch:function(){},clearFilter:function(){this.$refs.filterGroup.clear()},onFilterTop:function(e,t){console.log(e,t),this.loadList({})},onPageChange:function(e){console.log("页码改变 ==>",e),this.pageNum=e,this.loadList({})},onPageSizeChange:function(e){console.log("页数改变 ==>",e),this.pageSize=e,this.loadList({})},onSetPackageStatus:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,s["l"](e.id);case 3:n=a.sent,i=n.data,r=void 0===i?{}:i,t.$message.success("更改成功！"),t.loadList(),console.log(r),a.next=13;break;case 11:a.prev=11,a.t0=a["catch"](0);case 13:case"end":return a.stop()}}),a,null,[[0,11]])})))()}}},u=c,m=(a("f08b"),a("2877")),d=Object(m["a"])(u,n,i,!1,null,null,null);t["default"]=d.exports},f08b:function(e,t,a){"use strict";a("dd8b")},f102:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("yi-modal",{attrs:{"dialog-form-visible":e.visible,title:"packageAdd"===e.packageType?"新增套餐":"编辑套餐","modal-width":"850px"},on:{"on-close-dialog":e.onClose}},[a("div",{staticClass:"form-container"},["packageEdit"===e.packageType?[a("el-tabs",{attrs:{type:"card"},model:{value:e.tabActiveName,callback:function(t){e.tabActiveName=t},expression:"tabActiveName"}},[a("el-tab-pane",{attrs:{label:"基础信息",name:"base"}}),a("el-tab-pane",{attrs:{label:"套餐项目",name:"item"}}),a("el-tab-pane",{attrs:{label:"计费规则",name:"rule"}})],1)]:e._e(),"packageAdd"===e.packageType||"base"===e.tabActiveName?[a("div",{staticClass:"title"},[e._v("基础信息")]),a("div",{style:{width:"500px"}},[e.visible?a("yi-form",{ref:"createForm",attrs:{fields:e.form,"default-value":e.defaultValue},on:{"on-field-change":e.onFieldChange}}):e._e()],1)]:e._e(),"packageAdd"===e.packageType||"item"===e.tabActiveName?[a("div",{staticClass:"addButtonWrap"},[a("div",{staticClass:"title"},[e._v("套餐项目")]),a("div",[a("el-button",{staticClass:"addPackageBtn",staticStyle:{"font-size":"13px"},attrs:{type:"primary",icon:"el-icon-circle-plus",size:"mini"},on:{click:function(t){return e.onItemOpen("itemAdd")}}},[e._v("新增")])],1)]),a("div",{staticClass:"tableWrap"},[a("yi-table",{ref:"erpTable",attrs:{columns:e.getItemColumns,data:e.itemTableData},scopedSlots:e._u([{key:"itemType",fn:function(t){return[a("div",[e._v(e._s(e.getItemType(t.data)))])]}},{key:"content",fn:function(t){return[a("div",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.getContent(t.row)))])]}},{key:"operation",fn:function(t){return[a("div",[a("span",{staticClass:"link",on:{click:function(a){return e.onItemOpen("itemEdit",t.row,t.dateIndex)}}},[e._v("修改")]),a("span",{staticClass:"link",on:{click:function(a){return e.onItemDelete(t.dateIndex,t.row)}}},[e._v("删除")])])]}}],null,!1,1408449456)})],1)]:e._e(),"packageAdd"===e.packageType||"rule"===e.tabActiveName?[a("div",{directives:[{name:"show",rawName:"v-show",value:e.billingType,expression:"billingType"}]},[a("div",{staticClass:"addButtonWrap"},[a("div",{staticClass:"title"},[e._v("计费规则")]),a("div",[a("el-button",{staticClass:"addPackageBtn",staticStyle:{"font-size":"13px"},attrs:{type:"primary",icon:"el-icon-circle-plus",size:"mini"},on:{click:function(t){return e.onRuleOpen("ruleAdd")}}},[e._v("新增")])],1)]),a("div",{staticClass:"tableWrap"},[a("yi-table",{ref:"erpTable",attrs:{columns:e.getRuleColumns,data:e.ruleTableData},scopedSlots:e._u([{key:"numRange",fn:function(t){return[a("div",{staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(t.row.limitStart+"-"+t.row.limitEnd))])]}},{key:"operation",fn:function(t){return[a("div",[a("span",{staticClass:"link",on:{click:function(a){return e.onRuleOpen("ruleEdit",t.row,t.dateIndex)}}},[e._v("修改")]),a("span",{staticClass:"link",on:{click:function(a){return e.onRuleDelete(t.dateIndex,t.row)}}},[e._v("删除")])])]}}],null,!1,148847885)})],1)])]:e._e()],2),a("div",{directives:[{name:"show",rawName:"v-show",value:"packageAdd"===e.packageType||"base"===e.tabActiveName,expression:"packageType === 'packageAdd' || tabActiveName === 'base'"}]},[a("yi-form-operation",{attrs:{"cancel-text":"取 消","button-text":"确 定"},on:{"form-submit":e.onCreateSubmit,"form-reset":e.onClose}})],1)]),a("AddItem",{ref:"refAddItem",attrs:{"billing-type":e.billingType},on:{"on-change-success":e.onItemChange,"on-refresh":e.getPackageItemList}}),a("AddRule",{ref:"refRuleItem",attrs:{"billing-type":e.billingType},on:{"on-change-success":e.onRuleChange,"on-refresh":e.getPackageRuleList}})],1)},i=[],r=(a("99af"),a("4de4"),a("c740"),a("caad"),a("d81d"),a("a434"),a("b0c0"),a("d3b7"),a("96cf"),a("1da1")),o=a("5530"),l=a("6d47"),s=a("4466"),c=a("5770"),u=a("a1f4"),m={name:"Index",components:{AddItem:s["default"],AddRule:c["default"]},data:function(){return{defaultValue:{},visible:!1,form:l["default"].addForm,title:"新购",itemTableData:[],ruleTableData:[],billingType:null,packageType:"packageAdd",tabActiveName:"base",productInfo:{}}},computed:{enumStore:function(){return this.$store.state.global&&this.$store.state.global.enums||{}},getItemColumns:function(){return l["default"].packageItemList},getRuleColumns:function(){switch(this.billingType){case 1:return l["default"].packageRuleList.filter((function(e){return["timeLimit","price","operation"].includes(e.prop)}));case 2:return l["default"].packageRuleList.filter((function(e){return["numRange","price","operation"].includes(e.prop)}));case 3:return l["default"].packageRuleList;default:return[]}},itemTypeOptions:function(){return this.enumStore.itemType||[]},timeLimitTypeOptions:function(){return this.enumStore.timeLimitType||[]}},methods:{onCreateSubmit:function(){var e=this;this.$refs["createForm"].onAsyncSubmit().then((function(t){return console.log("新建表单参数 ==>",t),"packageAdd"===e.packageType?e.itemTableData.length?e.ruleTableData.length?u["e"](Object(o["a"])(Object(o["a"])({},t),{},{productName:e.productInfo.name,billingType:e.billingType,billingRules:e.ruleTableData,items:e.itemTableData})):(e.$message.error("计费规则不能为空"),Promise.reject()):(e.$message.error("套餐项目不能为空"),Promise.reject()):u["m"](Object(o["a"])(Object(o["a"])({},t),{},{billingType:e.billingType}))})).then((function(t){e.$message.success("操作成功！"),e.onClose(),e.$emit("on-change-success")})).catch((function(e){console.log(e)}))},onClose:function(){this.visible=!1,this.billingType=null,this.defaultValue={},this.productInfo={},this.itemTableData=[],this.ruleTableData=[],this.tabActiveName="base",this.form=l["default"].addForm},onOpen:function(e,t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(console.log("列表数据",e,t),n.prev=1,a.packageType=e,"packageAdd"!==e){n.next=7;break}a.form=l["default"].addForm,n.next=17;break;case 7:return t.onTrial&&(a.form=l["default"].addForm.map((function(e){return"trialDays"===e.key?Object(o["a"])(Object(o["a"])({},e),{},{hide:!1}):"productId"===e.key?Object(o["a"])(Object(o["a"])({},e),{},{readonly:!0}):e}))),a.billingType=t.billingType.code,n.next=11,u["a"](t.id);case 11:i=n.sent,r=i.data,console.log("详情数据",r),a.ruleTableData=r.billingRules,a.itemTableData=r.items.map((function(e){return console.log(e),Object(o["a"])(Object(o["a"])({},e),{},{timeLimitType:e.timeLimitType.code,itemType:e.itemType.code})})),a.defaultValue=r;case 17:n.next=22;break;case 19:n.prev=19,n.t0=n["catch"](1),console.log(n.t0);case 22:a.visible=!0;case 23:case"end":return n.stop()}}),n,null,[[1,19]])})))()},onFieldChange:function(e){var t=e.key,a=e.value,n=e.item;if("onTrial"===t&&(this.form=l["default"].addForm.map((function(e){return"trialDays"===e.key?Object(o["a"])(Object(o["a"])({},e),{},{hide:!a}):e}))),"productId"===t){var i=n.filter((function(e){return e.code===a}));if(i.length){var r=i[0].billingType.code;console.log("产品信息",i[0]),this.productInfo=i[0]||{},this.billingType!==r&&(this.billingType=i[0].billingType.code,this.ruleTableData=[])}}},operation:function(){},onItemOpen:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;this.billingType?this.$refs.refAddItem.onOpen(this.packageType,e,Object(o["a"])(Object(o["a"])({},t),{},{comboId:this.defaultValue.id}),a):this.$message.error("请先选择套餐所属产品")},onItemChange:function(e,t,a,n){"packageAdd"===e?"itemAdd"===t?this.itemTableData.push(JSON.parse(JSON.stringify(a))):this.$set(this.itemTableData,n,a):this.getPackageItemList()},onItemDelete:function(e,t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,"packageAdd"!==a.packageType){n.next=5;break}a.itemTableData.splice(e,1),n.next=9;break;case 5:return n.next=7,u["h"](t.id);case 7:i=n.sent,200===i.code&&(a.$message.success("删除成功！"),a.getPackageItemList());case 9:n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](0),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})))()},getPackageItemList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u["b"](e.defaultValue.id);case 3:a=t.sent,console.log("项目列表数据",a),e.itemTableData=a.data.map((function(e){return Object(o["a"])(Object(o["a"])({},e),{},{itemType:e.itemType.code,timeLimitType:e.timeLimitType.code})})),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},getItemType:function(e){try{var t=this.itemTypeOptions.findIndex((function(t){return t.code===e}));return this.itemTypeOptions[t].name}catch(a){console.log(a)}},onRuleOpen:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;this.$refs.refRuleItem.onOpen(this.packageType,e,Object(o["a"])(Object(o["a"])({},t),{},{comboId:this.defaultValue.id}),a)},onRuleChange:function(e,t,a,n){console.log(e,t,a,n),"packageAdd"===e?"ruleAdd"===t?this.ruleTableData.push(JSON.parse(JSON.stringify(a))):this.$set(this.ruleTableData,n,a):this.getPackageRuleList()},onRuleDelete:function(e,t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,"packageAdd"!==a.packageType){n.next=5;break}a.ruleTableData.splice(e,1),n.next=9;break;case 5:return n.next=7,u["i"](t.id);case 7:i=n.sent,200===i.code&&(a.$message.success("删除成功！"),a.getPackageRuleList());case 9:n.next=14;break;case 11:n.prev=11,n.t0=n["catch"](0),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,11]])})))()},getPackageRuleList:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u["d"](e.defaultValue.id);case 3:a=t.sent,e.ruleTableData=a.data,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getContent:function(e){switch(e.itemType){case 1:break;case 2:break;case 3:var t=this.timeLimitTypeOptions.findIndex((function(t){return t.code===e.timeLimitType})),a=this.timeLimitTypeOptions[t].name,n=e.increase?"可增购":"不可增购";return"时限：".concat(a,"、\n 标准数量：").concat(e.amount,"、\n ").concat(n)}}}},d=m,p=(a("2743"),a("2877")),f=Object(p["a"])(d,n,i,!1,null,"245b4c94",null);t["default"]=f.exports}}]);